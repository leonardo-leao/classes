\documentclass{article}
\usepackage{tpack}


% \usepgfplotslibrary{external} 
% \tikzexternalize


% \titleformat
%     {\subsection}           % Part
%     [block]                 % Part Shape
%     {\normalfont\Large}     % Font Size
%     {}                      % Label Numbering
%     {0mm}                   % Part Separation
%     {}                      % Code Before
%     []                      % Code After

%     \titlespacing*{\subsection}{0mm}{5mm}{2.5mm}


\title{EM607 - Vibrações Mecânicas}
\author{Guilherme Nunes Trofino}
\authorRA{217276}
\project{Atividade Teórica}


\begin{document}
    \maketitle
\newpage

\section{Atividade Teórica}
\paragraph{Apresentação}Resolução das questões de Vibrações Mecânicas por Guilherme Nunes Trofino, 217276, sobre a \textbf{Desacoplamento e Superposição Modal} de um Sistema de 1-DOF com Amortecimento Viscoso Forçado com as seguintes características:
\begin{enumerate}[noitemsep]
    \item $m_1$ e $m_2$, \textbf{Massa}: 1 kg;
    \item $k_2$, \textbf{Constante Elástica}: 0.8 MN/m;
    \item $k_1$ e $k_3$, \textbf{Constante Elástica}: 0.4 MN/m;
\end{enumerate}

\begin{exercise}\label{ex1}
    Determine as respectivas matrizes do Modelo Modal:
    \begin{enumerate}
        \item Matriz dos Autovalores: $[\bar{\omega}_n]$;
        \item Matriz dos Autovetores: $[\psi]$;
    \end{enumerate}
\end{exercise}
\begin{resolution}
    Considera-se as seguintes equações para o sistema de 2-DOF sem Amortecimento Viscoso Forçado por duas Entradas Harmônicas dadas por $f_1(t) = F_1 e^{j\omega t}$ e $f_2(t) = F_2 e^{j\omega t}$:
    \begin{equation*}
        \begin{cases}
            m_1 \ddot{x}_1 = -k_1 x_1 + k_2 (x_2 - x_1) + f_1\\
            m_2 \ddot{x}_2 = -k_3 x_2 - k_2 (x_2 - x_1) + f_2\\
        \end{cases}
        \to
        \underbrace{\begin{bmatrix} m_1 & 0\\ 0 & m_2\end{bmatrix}}_{\mathbf{M}} 
        \begin{Bmatrix} \ddot{x}_1\\ \ddot{x}_2\end{Bmatrix} + 
        \underbrace{\begin{bmatrix} k_1 + k_2 & -k_2\\ -k_2 & k_2 + k_3\end{bmatrix}}_{\mathbf{K}}
        \begin{Bmatrix} x_1\\ x_2\end{Bmatrix} =
        \begin{Bmatrix} f_1\\f_2\end{Bmatrix} 
    \end{equation*}
    Deseja-se encontrar as matrizes do Modelo Modal, dessa forma será necessário solucionar o seguinte Autoproblema $|\mathbf{K} - \omega^2\mathbf{M}| = 0$ como demonstrado a seguir:
    \begin{equation*}
        \begin{vmatrix}
            \begin{bmatrix} k_1 + k_2 & -k_2\\ -k_2 & k_2 + k_3\end{bmatrix} 
            -\omega^2 \begin{bmatrix} m_1 & 0\\ 0 & m_2\end{bmatrix}
        \end{vmatrix} = 0
        \quad\to\quad
        \begin{vmatrix}
            (k_1 + k_2) - \omega^2 m_1 & -k_2\\
            -k_2 & (k_2 + k_3) - \omega^2 m_2\\
        \end{vmatrix} = 0
    \end{equation*}
    Obtém-se a seguinte equação:
    \begin{equation*}
        \omega^4 m_1 m_2 - \omega^2 (m_2(k_1 + k_2) + m_1(k_2 + k_3)) + k_1 k_3 + k_2 k_3 + k_1 k_2 = 0
    \end{equation*}
    Quando considera-se os valores do exercício têm-se:
    \begin{equation*}
        \omega^4 - 2.4\cdot 10^{6} \omega^2 + 0.8\cdot 10^{12} = 0
        \quad \to \quad
        \begin{cases}
            \omega_1^2 = 0.4\cdot 10^{6}\text{ rad/s}\\
            \omega_2^2 = 2.0\cdot 10^{6}\text{ rad/s}
        \end{cases}
    \end{equation*}
    Na sequência será necessário substituir as Frequências Naturais obtidas na equação para determinar os respectivos Autovalores capazes de solucionar a seguinte equação $[\mathbf{K} - \omega^2\mathbf{M}]{x} = {0}$ como demonstrado a seguir:
    \begin{equation*}
        \begin{bmatrix} (k_1 + k_2) - \omega^2 m_1 & -k_2\\ -k_2 & (k_2 + k_3) - \omega^2 m_2\\\end{bmatrix} 
        \begin{Bmatrix} x_1 \\ x_2\end{Bmatrix} =
        \begin{Bmatrix} 0 \\ 0\end{Bmatrix}
        \quad \to \quad
        \begin{cases}
            \text{quando } \omega_1^2 \to x_1 = +x_2 & \psi_1 = \begin{Bmatrix} +1\\ +1\end{Bmatrix}\\
            \text{quando } \omega_2^2 \to x_1 = -x_2 & \psi_2 = \begin{Bmatrix} +1\\ -1\end{Bmatrix}
        \end{cases}
    \end{equation*}
    Dessa forma têm-se:
    \begin{equation}
        \boxed{
            [\bar{\omega}_n] = 
            \begin{bmatrix} \omega_1^2 & 0\\ 0 & \omega_2^2\end{bmatrix} = 
            \begin{bmatrix} 0.4 & 0\\ 0 & 2.0\end{bmatrix} \cdot 10^6
        }
        \quad\text{e}\quad
        \boxed{
            [\psi] = 
            \begin{bmatrix} \psi_1 & \psi_2\end{bmatrix} = 
            \begin{bmatrix} +1 & +1\\ +1 & -1\end{bmatrix}
        }
    \end{equation}
\end{resolution}


\newpage\begin{exercise}\label{ex2}
    Determine as respectivas matrizes na Base Modal:
    \begin{enumerate}
        \item Matriz de Massa Diagonalizadas: $\bar{m}_r$;
        \item Matriz de Rigidez Diagonalizadas: $\bar{k}_r$;
    \end{enumerate}
\end{exercise}
\begin{resolution}
    Parte-se da solução obtida no Exercício \ref{ex1} e realiza-se as seguintes operações:
    \begin{equation*}
        [\psi]^\intercal \mathbf{M} [\psi] = [\bar{m}_r] \to 
        \begin{bmatrix} +1 & +1\\ +1 & -1\end{bmatrix} 
        \begin{bmatrix} m_1 & 0\\ 0 & m_2\end{bmatrix} 
        \begin{bmatrix} +1 & +1\\ +1 & -1\end{bmatrix}
    \end{equation*}
    \begin{equation*}
        [\psi]^\intercal \mathbf{K} [\psi] = [\bar{k}_r] \to 
        \begin{bmatrix} +1 & +1\\ +1 & -1\end{bmatrix} 
        \begin{bmatrix} k_1 + k_2 & -k_2\\ -k_2 & k_2 + k_3\end{bmatrix} 
        \begin{bmatrix} +1 & +1\\ +1 & -1\end{bmatrix}
    \end{equation*}
    Dessa forma obtêm-se os seguintes resultados quando considera-se os valores do exercício:
    \begin{equation*}
        [\bar{m}_r] = 
        \begin{bmatrix} m_1+m_2 & m_1-m_2\\ m_1-m_2 & m_1+m_2\end{bmatrix} \to 
        \boxed{[\bar{m}_r] = \begin{bmatrix} 2 & 0\\ 0 & 2\end{bmatrix}}
    \end{equation*}
    \begin{equation*}
        [\bar{k}_r] = 
        \begin{bmatrix} k_1+k_3 & k_1-k_3\\ k_1-k_3 & k_1 + 4k_2 + k_3\end{bmatrix} \to 
        \boxed{[\bar{k}_r] = \begin{bmatrix} 0.8 & 0\\ 0 & 4.0\end{bmatrix}\cdot 10^6}
    \end{equation*}
    Nota-se que a Matriz dos Autovalores $[\psi]$ já considera os valores numéricos propostos pelo exercício. Dessa forma, os termos fora da diagonal principal devem ser zerados ao longo da dedução.\\

    Evidência-se que a Matriz dos Autovetores $[\psi]$ será sujeita a fatores de escala arbitrários. Dessa forma padroniza-se estas grandezas através da Normalização da Massa definida pela seguintes relação:
    \begin{equation}
        \boxed{[\phi] = [\psi] \times [\bar{m}_r]^{-1/2}}
        \quad \to \quad
        \boxed{[\phi]^\intercal \mathbf{M} [\phi] = [I]}
        \quad\text{e}\quad
        \boxed{[\phi]^\intercal \mathbf{K} [\phi] = [\bar{\omega}_r]}
    \end{equation}
    Onde $[\phi]$ será a Matriz de Autovetores Normalizada que será dada por:
    \begin{equation*}
        [\phi] = [\psi] \times [\bar{m}_r]^{-1/2}
        \to
        [\phi] = \begin{bmatrix} +1 & +1\\ +1 & -1\end{bmatrix} \begin{bmatrix} 1/\sqrt{2} & 0\\ 0 & 1/\sqrt{2}\end{bmatrix}
        \to 
        \boxed{[\phi] = \begin{bmatrix} \sqrt{2}/2 & \sqrt{2}/2\\ \sqrt{2}/2 & -\sqrt{2}/2\end{bmatrix}}
    \end{equation*}
    Na sequência implementa-se o seguinte algoritmo para determinar os gráficos de módulo e fase:
    \begin{scriptsize}
        \myMatlab\lstinputlisting[]{ex2.m}
    \end{scriptsize}
    Obtém-se seguinte resultado será obtido:
    \begin{scriptsize}
        \myMatlab\begin{lstlisting}
    MR =                KR = 1.0e+06 *          WR =                        PHI =
    
    1.0000         0        0.4000         0        400000           0          -0.7071   -0.7071
         0    1.0000             0    2.0000             0     2000000          -0.7071    0.7071
    \end{lstlisting}
    \end{scriptsize}
    Nota-se que o MATLAB já retorna a solução Normalizada do Autoproblema visto que a Matriz da Massa Normalizada será igual a Identidade e a Matriz da Rigidez será igual a Matriz das Frequências Naturais.\\

    Nota-se que a Matriz dos Autovalores Normalizada pela Massa possui o sinal oposto da obtida por cálculos. Entretanto isso não influenciou os resultados finais, pois a Normalização garante a compatibilidade dos resultados.
\end{resolution}


\newpage\begin{exercise}\label{ex3}
    Considere para os demais exercícios que $f_1 \neq 0$, Harmônica e não nula, e $f_2 = 0$.
\end{exercise}
\begin{exercise}\label{ex4}
    Determine as respectivas Equações do Movimento Desacopladas.
\end{exercise}
\begin{resolution}
    Considera-se genericamente as seguintes equações Matriciais para um sistema de n-DOF com Amortecimento Viscoso Forçado por Entradas Harmônicas:
    \begin{equation}
        \mathbf{M}\{\ddot{x}(t)\} + \mathbf{C}\{\dot{x}(t)\} + \mathbf{K}\{x(t)\} = \{f(t)\}\label{eq:nDOFAF}
    \end{equation}
    Na sequência realiza-se a seguinte Mudança de Base: $\{x\} = [\psi] \{p\}$, onde $[\psi]$ representa a Matriz de Autovalores não Normalizada. Dessa forma obtém-se:
    \begin{equation*}
        \mathbf{M}[\psi]\{\ddot{p}\} + \mathbf{C}[\psi]\{\dot{p}\} + \mathbf{K}[\psi]\{p\} = \{f\} \to
        \underbrace{[\psi]^\intercal\mathbf{M}[\psi]}_{[\bar{m}_{r}]}\{\ddot{p}\} + 
        \underbrace{[\psi]^\intercal\mathbf{C}[\psi]}_{[\bar{c}_{r}]}\{\dot{p}\} + 
        \underbrace{[\psi]^\intercal\mathbf{K}[\psi]}_{[\bar{k}_{r}]}\{p\} = 
        [\psi]^\intercal\{f\}
    \end{equation*}
    Nota-se que cada coordenada possui uma equação de um grau de liberdade, onde cada coordenada terá uma entrada composta por todas as entradas do sistema.\\
    
    Nota-se que a equação acima só será válida quando o Amortecimento for Proporcional, isto é, quando $[\bar{c}_r] = \alpha [\bar{m}_r] + \beta [\bar{k}_r]$.\\

    No caso do Exercício \ref{ex1} na condição do Exercício \ref{ex3} tém-se:
    \begin{equation*}
        \begin{bmatrix} 2 & 0\\ 0 & 2\end{bmatrix}\{\ddot{p}\} + 
        \begin{bmatrix} 0.8 & 0\\ 0 & 4.0\end{bmatrix}\cdot 10^6 \{p\} = 
        \begin{bmatrix} 1 & 1\\ 1 & -1\end{bmatrix}\begin{Bmatrix} f_1\\ 0\end{Bmatrix} \to
        \begin{cases}
            2 \ddot{p}_1 + 0.8 \cdot 10^6 p_1 = f_1(t)\\
            2 \ddot{p}_2 + 4.0 \cdot 10^6 p_2 = f_1(t)\\
        \end{cases}
    \end{equation*}
    Nota-se que neste caso $\alpha = \beta = 0$ para que o Desacoplamento seja possível.\\

    Na sequência implementa-se o seguinte algoritmo para determinar os gráficos de módulo e fase:
    \begin{scriptsize}
        \myMatlab\lstinputlisting[]{ex4.m}
    \end{scriptsize}
\end{resolution}


\newpage\begin{exercise}\label{ex5}
    Verifique as curvas de Resposta em Frequência associadas a cada Equação Desacopladas.
\end{exercise}
\begin{resolution}
    Considera-se a seguinte equação para um sistema de 1-DOF com Amortecimento Viscoso Forçado por uma Entrada Harmônica dada por $f(t) = F e^{j\omega t}$:
    \begin{equation}
        m_{ri}\ddot{p} + c_{ri}\dot{p} + k_{ri} p = f(t)\label{eq:1DOFAF}
    \end{equation}
    \noindent Propõem-se a seguinte solução: $p(t) = P e^{j\omega t}$. Na sequência substitui-se na Equação \ref{eq:1DOFAF} obtendo:
    \begin{align*}
        m\ddot{p}(t) + c\dot{p}(t) + k p(t) &= f(t)\\
        (-\omega^2 m + j \omega c + k) P e^{j\omega t} &= F e^{j\omega t}\\
        (-\omega^2 m + j \omega c + k) P \cancel{e^{j\omega t}} &= F \cancel{e^{j\omega t}}\\
        \frac{P}{F} &= \frac{1}{(k -\omega^2 m) + j \omega c}
    \end{align*}
    Nota-se que há o Deslocamento Harmônico divido pelo módulo da Força Harmônica o que configura a Receptância. Dessa forma conclui-se que:
    \begin{equation}
        \boxed{
            \alpha (\omega) = 
            \frac{p(t)}{f(t)} = 
            \frac{P e^{j\omega t}}{F e^{j\omega t}} = 
            \frac{P}{F} = 
            \frac{1}{(k -\omega^2 m) + j \omega c}
        }
    \end{equation}
    Define-se a Mobilidade como a razão entre a Velocidade e a amplitude da Força Harmônica que exita o sistema. Dessa forma tem-se, a partir da Equação \ref{eq:1DOFAF}, que:
    \begin{equation}
        \boxed{
            y (\omega) = 
            \frac{\dot{p}(t)}{f(t)} = 
            -j\omega\frac{P}{F} = 
            -j\omega \cdot \alpha(\omega) = 
            \frac{-j\omega}{(k -\omega^2 m) + j \omega c}
        }
    \end{equation}
    Define-se a Inertância como a razão entre a Aceleração e a amplitude da Força Harmônica que exita o sistema. Dessa forma tem-se, a partir da Equação \ref{eq:1DOFAF}, que:
    \begin{equation}
        \boxed{
            A (\omega) = 
            \frac{\ddot{p}(t)}{f(t)} = 
            -j\omega   \cdot     y (\omega) = 
            - \omega^2 \cdot \alpha(\omega) = 
            \frac{-\omega^2}{(k -\omega^2 m) + j \omega c}
        }
    \end{equation}
    Neste caso têm-se:
    \begin{equation*}
        \alpha_1(\omega) = \frac{1}{-2\omega^2 + 0.8\cdot 10^6} \qquad
         y_1(\omega) = \frac{j\omega}{-2\omega^2 + 0.8\cdot 10^6} \qquad
          A_1(\omega) = \frac{-\omega^2}{-2\omega^2 + 0.8\cdot 10^6}
    \end{equation*}    \begin{equation*}
        \alpha_2(\omega) = \frac{1}{-2\omega^2 + 4.0\cdot 10^6} \qquad
         y_2(\omega) = \frac{j\omega}{-2\omega^2 + 4.0\cdot 10^6} \qquad
          A_2(\omega) = \frac{-\omega^2}{-2\omega^2 + 4.0\cdot 10^6}
    \end{equation*}
    Na sequência implementa-se o seguinte algoritmo para determinar os gráficos de módulo e fase:
    \begin{scriptsize}
        \myMatlab\lstinputlisting[]{ex5.m}
    \end{scriptsize}
    Obtêm-se os seguintes gráficos:
    \begin{figure}[H]
        \centering
        \includegraphics[width=0.30\textwidth]{images/m1c0k2000000_rcpAbs_unc.png}
        \includegraphics[width=0.30\textwidth]{images/m1c0k2000000_mblAbs_unc.png}
        \includegraphics[width=0.30\textwidth]{images/m1c0k2000000_inrAbs_unc.png}
    \end{figure}
    \begin{figure}[H]
        \centering
        \includegraphics[width=0.30\textwidth]{images/m1c0k2000000_rcpAng_unc.png}
        \includegraphics[width=0.30\textwidth]{images/m1c0k2000000_mblAng_unc.png}
        \includegraphics[width=0.30\textwidth]{images/m1c0k2000000_inrAng_unc.png}
    \end{figure}
\end{resolution}


\newpage\begin{exercise}\label{ex6}
    Determine as Funções de Transferência da força para os deslocamentos de $m_1$ e $m_2$.
\end{exercise}
\begin{resolution}
    
\end{resolution}


\newpage\begin{exercise}\label{ex7}
    Determine as curvas de Receptância de $m_1$ e $m_2$ das Equações Desacopladas. (\ref{ex3})
\end{exercise}
\begin{resolution}
    
\end{resolution}


\newpage\begin{exercise}\label{ex8}
    Nota-se o efeito da Superposição Modal em Frequência?
\end{exercise}
\begin{resolution}
    
\end{resolution}


\newpage\begin{exercise}\label{ex9}
    Formule o sistema no Modelo de Estados.
\end{exercise}
\begin{resolution}
    
\end{resolution}


\newpage\begin{exercise}\label{ex10}
    Determine as curvas de Receptância de $m_1$ e $m_2$ no Modelo de Estados. (\ref{ex3})
\end{exercise}
\begin{resolution}
    
\end{resolution}


\newpage\begin{exercise}\label{ex11}
    Compare as respostas do Modelo de Estados com das Equações Desacopladas. Discuta.
\end{exercise}
\begin{resolution}
    
\end{resolution}


\newpage\begin{exercise}\label{ex12}
    Inclua Amortecimento Proporcional ao problema e verifique o Desacoplamento das Equações. Analise novamente as respectivas curvas variando o amortecimento.
\end{exercise}
\begin{resolution}
    
\end{resolution}


\newpage\begin{exercise}\label{ex13}
    Inclua Amortecimento Proporcional e verifique a Diagonalização das Matrizes de Massa e de Rigidez.
\end{exercise}
\begin{resolution}
    
\end{resolution}


\newpage\begin{exercise}\label{ex14}
    Determine a Matriz de Amortecimento Modal em sua Forma Padronizada. ($2\xi\omega_n$)
\end{exercise}
\begin{resolution}
    
\end{resolution}

\end{document}